# 声音可视化游戏 - 纪念碑谷风格

## 功能特点

🎵 **实时音频可视化**: 从麦克风获取声音，实时生成3D地形
🎮 **纪念碑谷风格**: 简洁的低聚建筑风格，等轴测投影视角
🏗️ **动态建筑生成**: 根据音调频率生成不同装饰（树木、房子、塔楼）
🎯 **小人行走**: 可控制的角色在生成的地形上行走
🔄 **视角切换**: 右下角按钮控制东南西北四个视角
📊 **实时数据**: 显示当前音量和主要频率信息

## 技术架构

- **音频处理**: PyAudio + NumPy FFT分析
- **3D渲染**: Pygame + OpenGL/等轴测投影
- **实时可视化**: 音量→方块高度，频率→装饰类型
- **流畅动画**: 平滑的高度变化和视角切换

## 安装和运行

### 方法1：单方块音频版 🎯 (最新，每次声音生成一个方块)
```bash
cd sound_visualization_game
pip install pygame numpy pyaudio scipy
python single_block_game.py
```

### 方法2：真实音频版 ⭐️ (基于真实麦克风)
```bash
cd sound_visualization_game
pip install pygame numpy pyaudio scipy
python real_audio_game.py
```

### 方法2：增强版 (推荐，最佳视觉效果)
```bash
cd sound_visualization_game
pip install pygame numpy
python enhanced_game.py
```

### 方法3：简化版 (快速体验)
```bash
cd sound_visualization_game  
pip install pygame numpy
python simple_game.py
```

### 方法4：完整版 (需要所有依赖)
```bash
cd sound_visualization_game
pip install -r requirements.txt
python main.py
```

### 方法5：一键启动 (Windows)
```bash
双击 setup.bat 文件，选择对应的运行模式
```

### 音频测试工具
```bash
python test_audio.py  # 测试麦克风是否正常工作
```

## 控制说明

- **鼠标左键**: 点击地面移动小人
- **右下角 ← 按钮**: 逆时针切换视角
- **右下角 → 按钮**: 顺时针切换视角
- **声音**: 对着麦克风发声看效果！

## 音频映射规则

### 单方块版映射规则 🎯 (最新)

| 音频特征 | 视觉效果 | 表面效果 |
|---------|---------|---------|
| **声音持续时间** | **方块高度** | - |
| **声音音量大小** | **颜色强度** | - |
| **低频(<200Hz)** | **蓝色海洋地形** | **🌊 动态波浪效果** |
| **中频(200-600Hz)** | **黄色沙漠地形** | **🏜️ 流动沙粒效果** |
| **高频(>600Hz)** | **绿色草地地形** | **🌱 摆动草坪效果** |

### 真实音频版映射规则 ⭐️

| 音频特征 | 视觉效果 |
|---------|---------|
| **声音持续时间** | **方块高度** |
| **声音音量大小** | **颜色强度** |
| **低频(<200Hz)** | **蓝色海洋地形** |
| **中频(200-600Hz)** | **黄色沙漠地形** |
| **高频(>600Hz)** | **绿色草地地形** |

### 其他版本映射规则

| 音频特征 | 视觉效果 |
|---------|---------|
| 音量大小 | 方块高度 |
| 低频(<200Hz) | 无装饰 |
| 中低频(200-500Hz) | 绿色树木 |
| 中高频(500-1000Hz) | 橙色房屋 |
| 高频(>1000Hz) | 紫色塔楼 |

## 文件结构

```
sound_visualization_game/
├── single_block_game.py # 🎯 单方块版 (每次声音生成一个方块，带表面效果)
├── real_audio_game.py   # ⭐️ 真实音频版 (基于真实麦克风输入)
├── enhanced_game.py     # 增强版游戏 (推荐视觉效果)
├── simple_game.py       # 简化版游戏 (快速体验)
├── main.py              # 完整版3D游戏 (OpenGL，需要更多依赖)
├── test_audio.py        # 音频设备测试工具
├── requirements.txt     # 完整依赖列表
├── README.md           # 说明文档
└── setup.bat           # Windows快速启动脚本
```

## 版本特色对比

| 特性 | 简化版 | 增强版 | 真实音频版 | 单方块版 | 完整版 |
|-----|-------|-------|-----------|---------|-------|
| 基础功能 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 纪念碑谷风格 | ⚫ | ✅ | ✅ | ✅ | ✅ |
| 粒子效果 | ❌ | ✅ | ❌ | ❌ | ✅ |
| 屏幕震动 | ❌ | ✅ | ❌ | ❌ | ✅ |
| 发光效果 | ❌ | ✅ | ❌ | ❌ | ✅ |
| 渐变背景 | ❌ | ✅ | ❌ | ✅ | ✅ |
| **真实麦克风** | ❌ | ❌ | ⭐️ | ⭐️ | ❌ |
| **智能生成逻辑** | ❌ | ❌ | ⭐️ | ⭐️ | ❌ |
| **静默等待机制** | ❌ | ❌ | ⭐️ | ⭐️ | ❌ |
| **🎯 单方块生成** | ❌ | ❌ | ❌ | ⭐️ | ❌ |
| **🌊 表面动态效果** | ❌ | ❌ | ❌ | ⭐️ | ❌ |
| 3D渲染 | ❌ | ❌ | ✅ | ✅ | ✅ |
| 性能要求 | 低 | 中 | 中 | 中 | 高 |

## 故障排除

### 音频问题
- Windows: 确保麦克风权限已开启
- 如果pyaudio安装失败，使用简化版的模拟模式
- 检查音频设备是否被其他程序占用

### 性能优化
- 简化版性能更好，推荐配置较低的电脑使用
- 完整版支持更丰富的3D效果但需要较好的显卡

### 兼容性
- Python 3.7+ 
- Windows/Linux/macOS
- 支持无音频设备的演示模式

## 开发说明

项目使用模块化设计：
- `AudioProcessor`: 实时音频分析
- `Camera`: 3D视角控制
- `TerrainBlock`: 地形方块管理
- `Character`: 角色移动逻辑

欢迎贡献代码和提出改进建议！